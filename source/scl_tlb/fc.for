!+
!
!      DSCL PROCEDURE *** FC ***
!      
!      THIS IS THE STANDARD SEQUENCE OF FALSE COLOUR CALCULATIONS
!      IT MAY BE USED AS A BLACK BOX , OR AS A GUIDE TO THE
!      THE REST OF THE FALSE COLOUR PACKAGE.
!
!
!      THE FALSE COLOUR PACKAGE IN ASPIC
!
!      WRITTEN BY K F HARTLEY AT RGO 10/8/81
!
!      EACH OF THE PROGRAMS STARS WITH THE LETTERS "FC"
!      AND IS DOCUMENTED SEPARATELY.
!      THESE NOTES DESCRIBE HOW THE PACKAGE FITS TOGETHER.
!
!      THE PROGRAMS ARE :
!
!      FCSCALE      ALLOWS RESCALING OF THE INTENSITIES OF
!                   3 STARLINK 2-D IMAGES SO THAT THEIR
!                   HISTOGRAMS AGREE , APPROXIMATELY.
!
!      FCPACK       TAKES 3 STARLINK IMAGES ("R,G,B")
!                   AND FORMS A SINGLE FALSE COLOUR IMAGE
!                   WHICH WHEN DISPLAYED WITH THE "APE" LUT
!                   GIVES A COLOURED DISPLAY.
!
!      FCTHSI       TAKES 3 STARLINK IMAGES (R G B) AND CONVERTS THEM
!                   INTO 3 NEW (H S I) IMAGES.
!
!      FCTRGB       TAKES 3 (H S I) IAGES AND CONVERTS THEM BACK
!                   INTO 3 (R G B) IMAGES.
!
!      FCSAT        APPLIES SATURATION ENHANCEMENT TO THE "S" IMAGE
!                   GENERATED BY FCTHSI.
!
!                   NB. IT CAN ALSO BE USEFUL TO REPLACE THE "I" IMAGE
!                   GENERATED BY FCTHSI WITH ITS LOGARITHM, AS
!                   COMPUTED BY THE ASPIC PROGRAM LOG.
!
!                   AFTER ANY OF THESE TRANSFORMATIONS FCTRGB SHOULD
!                   BE USED, FOLLOWED BY FCPACK.
!
!      LUTFC        THIS IS A CONVENIENT PROCEDURE FOR LOADING
!                   A SUITABLE LOOK-UP-TABLE INTO THE ARGS WHEN
!                   DISPLAYING A FALSE COLOUR IMAGE.
!                   THE LUT USED IS THE OLD 'KAPE' LUT , RENAMED
!                   FCLUT IN SYS:[STARPACK.LOCAL.ASPIC.BDF]
!
!      FCDISP       THIS DISPLAYS A FALSECOLOUR IMAGE WITH
!                   THE ABOVE LOOK-UP-TABLE AND THE MOST
!                   NATURAL ZOOM FACTOR.
!
WRITE SYS$OUTPUT "CONVERT TO HSI"
   FCTHSI HUE=H SAT=S INT=I
WRITE SYS$OUTPUT "ENHANCE SATURATION"
   FCSAT INPUT=S OUTPUT=SS
WRITE SYS$OUTPUT "TAKE LOGS OF THE INTENSITY IMAGE"
   LOG IN=I OUT=II 
WRITE SYS$OUTPUT "CONVERT BACK TO RGB"
   FCTRGB HUE=H SAT=SS INT=II RED=R GREEN=G BLUE=B
WRITE SYS$OUTPUT "PACK THE RGB IMAGES"
   FCPACK PACKED=$ RED=R GREEN=G BLUE=B
WRITE SYS$OUTPUT "OUTPUT NOW ON STACK NOW DISPLAY"
  ADISP $ = = 0 255
  AZOOM = = = = 
  LUTFC
WRITE SYS$OUTPUT "NOW SAVE IMAGE"
  STORE 
WRITE SYS$OUTPUT "DELETE ALL INTERMEDIATE IMAGES"
   DELETE R.BDF;*
   DELETE G.BDF;*
   DELETE B.BDF;*
   DELETE S.BDF;*
   DELETE H.BDF;*
   DELETE I.BDF;*
   DELETE II.BDF;*
   DELETE SS.BDF;*
EXIT
