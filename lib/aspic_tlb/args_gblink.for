	.TITLE ARGS_GBLINK
	.LIBRARY	/ARGSMAC/
	ARGSDEF	GBLINK,<^X400>

	ARGSINPUT
TAB1:
	I=0
	.REPEAT	256
	.BYTE	I,I,I,0
	I=I+1
	.ENDR
TAB2:
	I=0
	.REPEAT 256
	.BYTE	I,I,I,0
	I=I+1
	.ENDR
ZMX:	.WORD	0
ZMY:	.WORD	0
	ARGSOUTPUT
CX:	.WORD	0
CY:	.WORD	0
PICT:	.WORD	0
	ARGSOUTEND
	ARGSINEND
	I=0
	TB_INIT
	ARGSENTRY
	MOV	TAB1,TAB1+1022,VT1
	MOV	TAB2,TAB2+1022,VT2
	SETVV	ZMX,WORK
	ADDVV	ZMY,WORK
	SETVV	WORK,Z1+2
	SETVV	WORK,Z2+2
	TB_READ
LOOP:
	TB_READ
	SUBVV	TB_DELTAX,CX	; update x
	SUBVV	TB_DELTAY,CY	; update y
	SETVV	AUTO,WORK
	BRANZ	DIS1
	SETVV	TB_BUTTONS,WORK
	ANDLV	<^X0010>,WORK
	BRAZE	NBUT1
DIS1:	ZDO	0
	ZPA	16
	.WORD	<^X0000>,<^X0101>,<^X0202>,<^X0303>
	.WORD	<^X0404>,<^X0505>,<^X0606>,<^X0707>
	.WORD	<^X0808>,<^X0909>,<^X0A0A>,<^X0B0B>
	.WORD	<^X0C0C>,<^X0D0D>,<^X0E0E>,<^X0F0F>
	SETVV	CX,CS1+2
	XCL.	CS1
	SETVV	CY,CS1+2
	YCL.	CS1
Z1:	ZOM	0,8,0,0
	LVT	255,0
VT1:	.BLKW	512
	ZDO	255
DEL1:	DEL	0
	SETVV	AUTO,WORK
	BRANZ	DIS2
	DEV	4,5
L1:	.WORD	<^X0068>
	SETLV	1,PICT
	JRE	LOOP
NBUT1:
	SETVV	TB_BUTTONS,WORK
	ANDLV	<^X0020>,WORK
	BRAZE	NBUT2
DIS2:	ZDO	0
	ZPA	16
	.WORD	<^X0800>,<^X0901>,<^X0A02>,<^X0B03>
	.WORD	<^X0C04>,<^X0D05>,<^X0E06>,<^X0F07>
	.WORD	<^X0008>,<^X0109>,<^X020A>,<^X030B>
	.WORD	<^X040C>,<^X050D>,<^X060E>,<^X070F>
	XCL.	CS2
	YCL.	CS2
Z2:	ZOM	0,8,0,0
	LVT	255,0
VT2:	.BLKW	512
	ZDO	255
DEL2:	DEL	0
	SETVV	AUTO,WORK
	BRANZ	AON
	DEV	4,5
L2:	.WORD	<^X0058>
	SETLV	2,PICT
	JRE	LOOP
AON:
	SETVV	TB_BUTTONS,WORK
	ANDLV	<^X0030>,WORK
	BRAZE	NBUT2
	SETLV	0,AUTO
	SETLV	0,DEL1+2
	SETLV	0,DEL2+2
	SETVV	TB_BUTTONS,WORK
	ANDLV	<^X0010>,WORK
	BRAZE	DIS2
	JRE	DIS1
NBUT2:
	SETVV	TB_BUTTONS,WORK
	ANDLV	<^X0008>,WORK
	BRAZE	NBUT4
	SETLV	1,AUTO
	SETVV	DEL1+2,WORK
	BRANZ	UPD
	ADDLV	1,DEL1+2
	ADDLV	1,DEL2+2
	JMR	NBUT4
UPD:
	ADDVV	DEL1+2,DEL1+2
	ADDVV	DEL2+2,DEL2+2
NBUT4:
	ANDLV	<^X0040>,TB_BUTTONS
	BRAZE	LOOP
	STP



WORK:	.WORD	0

AUTO:	.WORD	0

CS1:	.WORD	0,0
CS2:	.WORD	0,256


	ARGSEND GBLINK

	.END

